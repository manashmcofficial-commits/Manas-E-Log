<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Yo Manas</title>
    <link rel="stylesheet" href="style.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <script async defer src="https://apis.google.com/js/api.js" onload="gapiLoaded()"></script>
    <script async defer src="https://accounts.google.com/gsi/client" onload="gisLoaded()"></script>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1><i class="fa-solid fa-trophy">&nbsp;&nbsp;</i>Manas Hostel E-Log</h1>
            <p>Hostel Facility Management System</p>
        </div>
        

        <div class="main-content">
            <div class="section">
                <h2><i class="fa-solid fa-plug"></i> Connect to Cloud</h2>
                <p style="font-size: 0.9em; opacity: 0.7; margin-bottom: 15px;">
                    Connect your account to automatically sync logs to a Google Sheet in real-time.
                </p>
                <button id="authorize_button" class="btn" style="display: none;">Connect Google Account</button>
                <button id="signout_button" class="btn" style="display: none;">Disconnect</button>
                <div id="g-sheet-status" style="margin-top: 15px;"></div>
            </div>

            <div class="section">
                <h2><i class="fa-solid fa-arrow-up-from-bracket"></i> Issue Equipment</h2>
                <div class="form-group">
                    <label>Roll Number</label>
                    <input type="text" id="rollNo" placeholder="Enter student's roll number">
                </div>
                <button class="btn" onclick="lookupStudent()">Find Student</button>

                <div id="issueStatus"></div>

                <div id="studentInfo" style="display: none;">
                    <div class="student-info">
                        <h3>Student Information</h3>
                        <div class="info-grid">
                            <div class="info-item">
                                <div class="info-label">Name</div>
                                <div class="info-value" id="studentName">-</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Roll Number</div>
                                <div class="info-value" id="studentRoll">-</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Room Number</div>
                                <div class="info-value" id="studentRoom">-</div>
                            </div>
                            <div class="info-item">
                                <div class="info-label">Phone Number</div>
                                <div class="info-value" id="studentPhone">-</div>
                            </div>
                        </div>
                    </div>

                    <div class="form-group">
                        <label>Facility Type</label>
                        <select id="facilityType">
                            <option value="">Select Facility</option>
                            <option value="Sports">Sports</option>
                            <option value="Gym">Gym</option>
                            <option value="Music Room">Music Room</option>
                            <option value="Pantry">Pantry</option>
                        </select>
                    </div>

                    <div class="form-group" id="sportsEquipmentGroup" style="display: none;">
                        <label>Sports Equipment</label>
                        <select id="sportsEquipment">
                            <option value="">Select Equipment</option>
                            <option value="Pool">Pool</option>
                            <option value="Table Tennis">Table Tennis Rackets (Pair)</option>
                            <option value="Cricket Kit">Cricket Kit</option>
                            <option value="Football">Football</option>
                            <option value="Basketball">Basketball</option>
                            <option value="Volleyball">Volleyball</option>
                            <option value="Squash">Squash Rackets (Pair)</option>
                            <option value="Tennis">Tennis Rackets (Pair)</option>
                            <option value="Badminton Rackets">Badminton Rackets (Pair)</option>
                        </select>
                    </div>

                    <button class="btn" onclick="issueEquipment()">Issue Equipment</button>
                </div>
            </div>

            <div class="section">
                <h2><i class="fa-solid fa-list"></i> Active Loans</h2>
                <div class="table-container">
                    <table id="activeLoansTable">
                        <thead>
                            <tr>
                                <th>Roll No</th>
                                <th>Name</th>
                                <th>Room</th>
                                <th>Phone</th>
                                <th>Equipment</th>
                                <th>Out Time</th>
                                <th>Action</th>
                            </tr>
                        </thead>
                        <tbody id="activeLoansBody">
                            <tr>
                                <td colspan="7" style="text-align: center; padding: 30px;">No active loans</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2><i class="fa-solid fa-clock-rotate-left"></i> History</h2>
                <div class="table-container">
                    <table id="transactionTable">
                        <thead>
                            <tr>
                                <th>Date</th>
                                <th>Roll No</th>
                                <th>Name</th>
                                <th>Phone</th>
                                <th>Equipment</th>
                                <th>Out Time</th>
                                <th>In Time</th>
                                <th>Status</th>
                            </tr>
                        </thead>
                        <tbody id="transactionBody">
                            <tr>
                                <td colspan="8" style="text-align: center; padding: 30px;">No transactions yet</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <div class="section">
                <h2><i class="fa-solid fa-download"></i> Data Export</h2>
                <div class="form-group">
                    <label>Download Local Backup</label>
                    <div class="button-group">
                        <button class="btn" onclick="downloadLogs('Sports')">Sports Logs</button>
                        <button class="btn" onclick="downloadLogs('Gym')">Gym Logs</button>
                        <button class="btn" onclick="downloadLogs('Music Room')">Music Logs</button>
                        <button class="btn" onclick="downloadLogs('Pantry')">Pantry Logs</button>
                        <button class="btn" onclick="downloadLogs()">All Logs</button>
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <script src="script.js"></script>
</body>
</html>